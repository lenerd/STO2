\documentclass[a4paper]{scrartcl}

% font/encoding packages
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{lmodern}
\usepackage[ngerman]{babel}
\usepackage[ngerman=ngerman-x-latest]{hyphsubst}

\usepackage{amsmath, amssymb, amsfonts, amsthm}
\usepackage{array}
\usepackage{stmaryrd}
\usepackage{marvosym}
\allowdisplaybreaks
\usepackage[output-decimal-marker={,}]{siunitx}
\usepackage[shortlabels]{enumitem}
\usepackage[section]{placeins}
\usepackage{float}
\usepackage{units}
\usepackage{listings}
\usepackage{pgfplots}
\pgfplotsset{compat=1.12}
\usepackage{tikz}
\usetikzlibrary{arrows,automata}

\usepackage{xcolor}
\definecolor{light-gray}{HTML}{cccccc}


\newtheorem*{behaupt}{Behauptung}
\newcommand{\gdw}{\Leftrightarrow}
\newcommand{\dif}{\ \mathrm{d}}
\newcommand{\N}{\mathbb{N}}
\newcommand{\prob}{\mathbb{P}}
\newcommand{\cov}{\operatorname{Cov}}
\newcommand{\e}{\mathbb{E}}
\newcommand{\var}{\operatorname{Var}}
\newcommand{\corr}{\operatorname{Corr}}

\usepackage{fancyhdr}
\pagestyle{fancy}

\lstset{%
    frame=single,
    numbers=left,
    keepspaces,
    language=R,
    title=Listing: \lstname,
}

\def \blattnr {12}

\lhead{Stochastik 2 - Blatt {\blattnr}}
\rhead{Florian Abt, Lennart Braun, Sascha Schulz}
\cfoot{\thepage}


\title{Stochastik 2 für Informatiker}
\subtitle{Blatt {\blattnr} Hausaufgaben}
\author{
    Florian Abt (6524404), \\
    Lennart Braun (6523742), \\
    Sascha Schulz (6434677)
}
\date{zum 19. Januar 2016}
\usepackage{pdfpages} 

\begin{document}
\maketitle

\begin{enumerate}[label=\bfseries \blattnr.\arabic*]
    \item %.1
       Im Fall von k=0.5 scheint die Breite der Konfidenzintervalle bei 
       steigendem n und konstantem Konfidenzniveau monoton zu fallen.
       
       Bei k=1.5 und k=2.5 ist diese Monotonie nur bedingt zu beobachten, es 
       kommt zu Sprungstellen, in denen einzelne (seltene) extreme 
       Werte dazu führen, dass das Konfidenzintervalle sprungartig wieder sehr 
       viel breiter wird.
       

	  \includegraphics[width=.33\textwidth, page=1]{Rplots.pdf}
	  \includegraphics[width=.33\textwidth, page=2]{Rplots.pdf}
	  \includegraphics[width=.33\textwidth, page=3]{Rplots.pdf}
       
       Anmerkung: Die x-Achse repräsentiert Anzahl der ersten n berücksichtigten 
       Samples mit $2\leq n \leq 1000$, die y-Achse repräsentiert die Breite 
       der Konfidenzintervalle. Die konkrete Darstellung ist stark von der 
       zufälligen Eingabe abhängig, lediglich das oben beschriebene Grundmuster
       lässt sich bei wiederholter Ausführung erkennen.

    \item %.2
        \begin{enumerate}
            \item
              Die Inversionsmethode kann angewendet werden, da die $U_i$ iid auf 
              [0,1) und gleichverteilt sind. Außerdem ist F rechtsseitig stetig 
              sodass stets \\ 
              $\mathbb{P}(U\leq F(x))=F(x)$.
              
	      \begin{equation*}
		F^{-1}(y) = \begin{cases}
			      1 &, y \in \left[0,\frac16 \right) \\
			      2 &, y \in \left[\frac16, \frac26 \right)\\
			      3 &, y \in \left[\frac26,\frac36 \right)\\
			      4 &, y \in \left[\frac36,\frac46 \right)\\
			      5 &, y \in \left[\frac46,\frac56 \right)\\
			      6 &, y \in \left[\frac56,1 \right)
		            \end{cases}
	      \end{equation*}
	      
            \item
	      \begin{tabular}{c|c|c|c|c|c}
	       $i$ & 1 & 2 & 3 & 4 & 5 \\
	       \hline
	       $u_i$ & 0.1 & 0.32 & 0.88 & 0.02 & 0.7 \\
	       \hline
	       $x_i$ & 1 & 2 & 9 & 1 & 8
	      \end{tabular}

            \item

        \end{enumerate}

    \item %.3
        Es seien die Dichten $f_X$ und $f_Z$ wie folgt gegeben.
        \begin{equation*}
            f_X(x) =
            \begin{cases}
                \frac{3}{4} (1-x^2), & |x| \leq 1 \\
                0,                   & |x| > 1    \\
            \end{cases}
            \qquad\qquad
            f_Z(x) =
            \begin{cases}
                1 - |x|, & |x| \leq 1 \\
                0,       & |x| > 1    \\
            \end{cases}
        \end{equation*}
        Weiterhin steht eine Möglichkeit zur Generierung von uniform verteilten
        Zufallszahlen auf $[0,1)$ zur Verfügung.
        \begin{enumerate}
            \item
                Die Dichten $f_X$ und $f_Z$ werden durch $g_X$ und $g_Z$ nach
                oben beschränkt:
                \begin{equation*}
                    f_X(x)
                    \leq g_X(x)
                    = \frac{3}{2} \cdot f_Y(x)
                    \qquad\qquad
                    f_Z(x)
                    \leq g_Z(x)
                    = 2 \cdot f_Y(x)
                \end{equation*}
                Der Faktor $c$ wird hier so gewählt, dass die Dichte $f_Y$ (im
                Intervall $[-1,1]$ gleich $\frac{1}{2}$) auf das Maximum von
                $f_X$ bzw. $f_Z$ scaliert wird. Dieses beträgt $\frac{3}{4}$
                bzw. $1$.

                Dabei sei $f_Y$ die Dichte einer Gleichverteilung auf $[-1,1)$.
                Seien $y'_i$ Zufallszahlen, die gemäß einer Gleichverteilung
                aus $[0,1)$ gezogen wurden. Dann sind $y_i = 2y'_i - 1$
                gleichverteilte Zufallszahlen aus $[-1,1)$.

                Um mit der Acceptance-Rejection-Methode Zufallszahlen gemäß der
                Dichte $f_X$ bzw. $f_Z$ zu erzeugen, wird wie folgt vorgegangen:
                \begin{enumerate}
                    \item
                        Generiere eine Zufallszahl $y$ gemäß $f_Y$.

                    \item
                        Generiere eine Zufallszahl $u$ gemäß einer
                        Gleichverteilung auf $[0,1)$.

                    \item
                        Falls $u \leq \frac{f_X(y)}{g_X(y)}$ bzw. $u \leq
                        \frac{f_Z(y)}{g_Z(y)}$ gebe $y$ zurück, sonst beginne
                        wieder mit Schritt i.

                \end{enumerate}
                Die zurückgegebene Zahl $y$ ist gemäßt $f_X$ bzw. $f_Y$
                verteilt.

            \item
                Für $c \to \infty$ gilt $\frac{f_X(y)}{g_X(y)} =
                \frac{f_X(y)}{c \cdot f_Y(y)} \to 0$. Je größer $c$ ist, desto
                kleiner ist also der Bereich, in dem die Zufallszahl abgelehnt
                wird. Man sollte $c$ also möglichst klein wählen, um weniger
                Zufallszahlen zu verschwenden.

            \item
                Würden die gleichen Zufallszahlen zum Erzeugen einer
                Realisierung von $X_{2n-1}$ und $Z_{2n}$ verwendet werden, so
                wären $X_{2n-1}$ und $Z_{2n}$ nicht länger stochastisch
                voneinander unabhängig.

        \end{enumerate}

\end{enumerate}

\end{document}

